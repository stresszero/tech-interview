## TCP란

- 전송 제어 프로토콜(Transmission Control Protocol)은 인터넷 프로토콜 스위트(IP)의 핵심 프로토콜 중 하나로, IP와 함께 TCP/IP라는 명칭으로도 널리 불린다.
- OSI 모형에서는 전송 계층에서 사용하는 규약이다.
- 개발 동기: 패킷교환 방식 이전에는 회선교환(서킷 스위칭) 방식이 일반적이었는데 이 방식은 네트워크 경로가 정해져 있어서 그 경로에 문제가 생기면 통신이 바로 끊어지는 문제점이 있었다. 이를 보완하기 위해 패킷교환(패킷 스위칭) 방식이 나왔다.
  
- 패킷교환 방식은 경로가 정해져 있지 않기 때문에 어떤 경로에 문제가 생기더라도 우회 경로를 이용하여 계속 통신을 할 수가 있다. 다만 이 방식은 안정성이 떨어질 수 밖에 없기 때문에 중간에 데이터가 유실되거나 너무 늦게 전달되는 등 신뢰성이 떨어지는 문제점이 있었다. 이러한 문제점을 해결하고자 나온 것이 TCP이다.
- TCP는 패킷 사이의 순서를 보장하고 연결지향 방식(3way handshake)으로 신뢰성을 구축한다.
- 수신 여부를 확인하며 가상회선 패킷 교환 방식을 사용한다.
- 가상회선 패킷 교환 방식은 각 패킷이 전송된 순서대로 도착하는 방식이다.
- 데이터그램 패킷 교환 방식은 패킷이 독립적으로 이동하며 도착한 순서가 다를 수 있는 방식이다.

## TCP의 특징

- TCP는 전화를 거는 것처럼 상대와 연결을 설정하고 통신을 시작한다. 절차는 아래와 같다.
- Three Way Handshake
    - 상대에게 통신을 하고 싶다는 메시지를 보낸다. (SYN)
    - 상대는 그 메시지에 대한 응답 + 나도 통신 준비가 되었다는 메시지를 보낸다. (SYN-ACK)
    - 2번에서 받은 메시지에 응답을 보낸다. (ACK)
- 이와 같은 과정을 통해 나와 상대가 통신준비를 마쳤고, 현재 통신이 연결되어 있음을 보장하게 된다. 기존의 회선교환 방식과 유사하지만 단순히 서로 연결되어 있다는 것만 보장한다.
- 흐름 제어: 수신 측이 송신 측보다 데이터 처리 속도가 빠르면 문제가 없지만, 송신 측의 속도가 빠를 경우 문제가 생긴다. 수신 측에서 제한된 저장 용량을 초과한 이후에 도착하는 패킷은 손실될 수 있으며, 만약 손실된다면 불필요한 추가 패킷 전송이 발생하게 된다. 흐름 제어는 위와 같이 송신 측과 수신 측의 TCP 버퍼 크기 차이로 인해 생기는 데이터 처리 속도 차이를 해결하기 위한 기법이다.
  
- 혼잡 제어: 데이터의 양이 라우터가 처리할 수 있는 양을 초과하면 초과된 데이터는 라우터가 처리하지 못한다. 이때 송신 측에서는 라우터가 처리하지 못한 데이터를 손실 데이터로 간주하고 계속 재전송하여 네트워크를 혼잡하게 한다. 이런 상황은 송신 측의 전송 속도를 적절히 조절하여 예방할 수 있는데, 이것을 혼잡 제어라고 한다.
- 정리하자면, 흐름 제어는 송 수신 측 사이의 패킷 수를 제어하는 기능이라 할 수 있으며, 혼잡 제어는 네트워크 내의 패킷 수를 조절하여 네트워크의 오버플로우를 방지하는 기능이다.

## UDP란

- 사용자 데이터그램 프로토콜(User Datagram Protocol, UDP)은 인터넷 프로토콜 스위트(IP)의 주요 프로토콜 가운데 하나이다. 1980년에 데이빗 리드가 설계하였고, 현재 IETF의 RFC 768로 표준으로 정의되어 있으며, TCP와 함께 데이터그램으로 알려진 단문 메시지를 교환하기 위해서 사용된다.
- TCP와 마찬가지로 OSI 모형에서는 전송 계층에서 사용하는 규약이다.

## UDP의 특징

- TCP의 모든 신뢰성 기능이 없는 프로토콜이라 보면 된다.
- 신뢰성이 보장되지 않기 때문에 UDP로 데이터를 보내면 손실 되는 데이터가 발생할 수 있다.
- UDP 헤더에는 목적지주소, 데이터순서, checksum과 실 데이터만 포함되고, 확인 응답 같은 것이 없기 때문에 TCP보다 용량이 가볍고 송신속도가 빠르다. 하지만 확인 응답을 하지 못하기 때문에 신뢰도가 TCP보다 떨어지게 된다. 따라서 UDP는 비연결형(Connectionless)이라 부르며 TCP는 연결지향(Connection-oriented)이라 구분한다.
- UDP에는 스스로 속도제어를 하는 기능이 없다. 따라서 초기 TCP가 겪었던 문제를 고스란히 안고 있다. 한 회선에서 몇몇 사람들이 UDP로 사용하면, 결국 소수에 의해 대역폭이 점유당해 다른 사람들이 통신을 못하는 상황이 빚어질 수 있다.
  
- 그렇기 때문에 네트워크 관리자 측에서 UDP가 쓸 수 있는 대역폭을 강제로 제한해버리거나 아예 UDP로 일정량 이상의 데이터가 들어오면 자동으로 차단하게 만드는 등의 방법을 쓰고 있다. 네트워크 관리자 입장에서는 이래저래 **필요악**으로 취급하고 있다. 국내 ISP의 경우 UDP 통신을 별도로 제한을 걸고 있지는 않지만, 학교나 회사와 같은 곳에서는 UDP에 제한을 거는 경우가 많다.
- 스트리밍 분야나 VoIP, mVoIP에서 사용되고 있다. 이런 서비스들은 실시간성 보장이 중요하기 때문에 TCP로 전송하면 매우 비효율적인 시스템이 된다.
- 온라인 게임의 서버-클라이언트 통신에도 대부분 UDP가 사용된다.
- 신뢰성을 보완하는 작업을 통해 UDP로도 TCP와 같이 신뢰성 있는 네트워크를 구축할 수 있다. UDP의 단점을 보완하여 새롭게 개발된 P2P 프로토콜들이 있으며 차세대 통신 프로토콜인 QUIC와 HTTP/3 역시 UDP를 보완한 것이다.

## TCP와 UDP의 차이

- 데이터를 전송하는데 발생하는 오류의 종류 3가지가 있음
- TCP는 전부 방지 및 제거 가능, UDP는 패킷 내부 손상만 방지 가능
    - 패킷의 잘못된 순서(TCP는 시퀀스)
    - 패킷 손실(TCP는 재전송 가능)
    - 패킷 내부의 손상된 데이터(UDP, TCP 모두 체크섬을 기반으로 체크 가능)

![https://velog.velcdn.com/images/stresszero/post/4100ef32-14a3-489a-8371-a2d65360bf26/image.png](https://velog.velcdn.com/images/stresszero/post/4100ef32-14a3-489a-8371-a2d65360bf26/image.png)


### TCP와 UDP의 구성요소 차이
![](https://velog.velcdn.com/images/stresszero/post/16b08325-a707-4384-9c7a-f2975aa6386a/image.png)