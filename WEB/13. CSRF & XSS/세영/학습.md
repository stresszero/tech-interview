# CSRF & XSS

## CSRF
- CSRF는 사이트 간 요청 위조(Cross Site Request Forgery) 약자이다.
- 웹 애플리케이션 취약점 중 하나로 특정 사용자의 권한 탈취 보다는, 사용자가 자신의 의지와 무관하게 공격자가 의도한 행동을 하게 만드는 공격이다.
- CSRF 공격방법
  - 웹사이트를 이용하면서 발생하는 패킷을 분석하여 어떤 경로로 어떤 요청이 가는지 분석
  - 분석 후 HTTP 요청 취약점을 파악하고 게시판이나 메일 등을 이용해서 악성 스크립트가 실행되게 만듬
  - 일단 스크립트가 실행되면, 사용자는 자신의 의지와 무관하게 공격자가 의도한 행동을 하게 됨
  - 악성 스크립트는 생각보다 많은 일을 할 수 있음(계정 정보 탈취 등)

- 대처 방법
  - 폼 전송이 필요한 작업을 하는 경우 CSRF 토큰이라는 이용자별 고유한 값을 만들어내고 이후 폼 전송시 같이 전송되는 CSRF 토큰이 발급해 뒀던 토큰과 일치하지 않는 경우 오류를 발생시킴
  - 비밀번호 변경 등 민감한 정보를 다룰 때에는 세션에 임의난수(토큰)을 발급해서, 해당 난수가 없다면 요청을 거부
  - CAPTCHA등을 이용하여 중요한 정보를 변경할 때 인증코드를 요구
  - 용도에 맞게 GET/POST 사용
  - FORM을 쓰지 말고 JSON으로만 통신

## XSS
- XSS는 크로스 사이트 스크립팅(Cross Site Scripting) 약자이다.
- SQL injection과 함께 웹 상에서 가장 기초적인 취약점 공격 방법의 일종으로, 악의적인 사용자가 공격하려는 사이트에 스크립트를 넣어 원하지 않는 악성 코드가 실행되는 기법을 말한다.
  
- 공격 방법에 따라 Stored XSS와 Reflected XSS로 나뉜다. Stored XSS는 사이트 게시판이나 댓글, 닉네임 등 스크립트가 서버에 저장되어 실행되는 방식이고, Reflected XSS는 보통 URL 파라미터(특히 GET 방식)에 스크립트를 넣어 서버에 저장하지 않고 그 즉시 스크립트를 만드는 방식이다. 
- 후술된 내용 대부분은 Stored XSS라고 생각하면 된다. Reflected XSS의 경우 브라우저 자체에서 차단하는 경우가 많아 상대적으로 공격을 성공시키기 어렵다.
- 공격 기법
  - 웹사이트의 취약점을 알아내어 스크립트 태그로 악성 자바스크립트 코드를 실행시킴
  - 링크 태그 사용
  - 이벤트 속성 사용
  - 내용 난독화
  - 스크립트 난독화
- 방법 방법
  - 입력 필터 활용
  - 관련 라이브러리 활용
  - 출력 필터 활용
  - 보안 쿠키 활용, 중용한 쿠키는 httponly로 관리
